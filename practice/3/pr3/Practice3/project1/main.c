#include <8051.h>

void main() {
    unsigned int i, cnt = 0, a = 0, count = 0;
    unsigned char *str = "        Hello!";         // ?????? ?????? ??????? (? ?????????)
    unsigned short *str2 = "#224/, #232/, #224/, #220/"; // ?????? ?????? (????????, ?????? ? ??????)

    // ????????????? ???????
    P0 = 0x38;     // 8-?????? ?????, 2 ??????, ????? 5x8
    P2 = 0x1;      // ?????? ?????? ??????? (E=1)
    P2 = 0x0;      // ????? E (??????)
    P0 = 0x80;     // ????????? ?????? DDRAM (?????? ?????? ??????)
    P2 = 0x1;
    P2 = 0x0;

    // ????? ?????? ?????? "Hello!"
    for(i = 0; i < 14; i++) {
        P0 = str[i];  // ???????? ???????
        P2 = 0x3;    // ?????? ?????? ?????? (RS=1, E=1)
        P2 = 0x2;    // ????? E
    }

    // ??????? ?? ?????? ??????
    P0 = 0xC0;     // ????? ?????? ??????
    P2 = 0x1;
    P2 = 0x0;
    i = 15;        // ????? ?????? str2 (??? ????????)

    // ??????????? ???? ?????????? ?????? ??????
    while(1) {
        // ????? ????? ?????? str2
        while (cnt < i) {
            P0 = str2[cnt]; // ???????? ??????? (???????? ?????? ??-?? ???? short*)
            P2 = 0x3;
            P2 = 0x2;
            cnt++;
        }

        cnt = i - count; // ???????? ??? "??????? ??????"

        // ?????????? ?????? (?????? ??????? ????????)
        while (cnt < 15) {
            if(a < count) {
                a++;
                P0 = str2[a-1]; // ????????? ????? ????????
                P2 = 0x3;
                P2 = 0x2;
                cnt++;
            }
        }

        // ????? ??????????
        a = 0;
        P0 = 0xC0;     // ??????? ? ?????? ?????? ??????
        P2 = 0x1;
        P2 = 0x0;
        count++;       // ?????????? ???????? (???? ????????????)
        cnt = count;   // ?????????? ??????? ??????
    }
}